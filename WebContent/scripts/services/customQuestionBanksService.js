'use strict';

angular.module('evalu8Demo')
		
.service('CustomQuestionBanksService', 
					['$http', '$rootScope', '$location', '$cookieStore', 
					 function($http, $rootScope, $location, $cookieStore) {
						
			$rootScope.globals = $cookieStore.get('globals') || {};
			
			 if ($rootScope.globals.authToken == '') {
				 $location.path('/login');
			 } 
			 
			 var MultipleChoice_Template = '<?xml version="1.0" encoding="utf-8"?><assessmentItem xmlns="http://www.imsglobal.org/xsd/imsqti_v2p1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.imsglobal.org/xsd/imsqti_v2p1 http://www.imsglobal.org/xsd/qti/qtiv2p1/imsqti_v2p1.xsd" title="Pre 1.1.2" identifier="QUESTION-1000001217597854" label="Pre 1.1.2" toolName="pegasus" toolVersion="5.152.49.2" adaptive="false" timeDependent="false"><responseDeclaration identifier="RESPONSE" cardinality="single" baseType="identifier"/><outcomeDeclaration identifier="FEEDBACK" cardinality="single" baseType="identifier"/><outcomeDeclaration identifier="ITEMSCORE" cardinality="single" baseType="float"/><outcomeDeclaration identifier="SCORE" cardinality="single" baseType="float" normalMaximum="1.00"><defaultValue><value>0</value></defaultValue></outcomeDeclaration><outcomeDeclaration identifier="MAXSCORE" cardinality="single" baseType="float"><defaultValue><value>1.00</value></defaultValue></outcomeDeclaration><itemBody><p></p><choiceInteraction shuffle="true" responseIdentifier="RESPONSE" maxChoices="1" minChoices="1"><simpleChoice identifier="RESPONSE_1" fixed="false"></simpleChoice><simpleChoice identifier="RESPONSE_2" fixed="false"></simpleChoice><simpleChoice identifier="RESPONSE_3" fixed="false"></simpleChoice><simpleChoice identifier="RESPONSE_4" fixed="false"></simpleChoice></choiceInteraction></itemBody><responseProcessing><responseCondition><responseIf><match><variable identifier="RESPONSE"/><baseValue baseType="identifier">RESPONSE_1</baseValue></match><setOutcomeValue identifier="SCORE"><baseValue baseType="float">1</baseValue></setOutcomeValue><setOutcomeValue identifier="FEEDBACK"><baseValue baseType="identifier">FEEDBACK_1</baseValue></setOutcomeValue></responseIf><responseElseIf><match><variable identifier="RESPONSE"/><baseValue baseType="identifier">RESPONSE_2</baseValue></match><setOutcomeValue identifier="SCORE"><baseValue baseType="float">0</baseValue></setOutcomeValue><setOutcomeValue identifier="FEEDBACK"><baseValue baseType="identifier">FEEDBACK_2</baseValue></setOutcomeValue></responseElseIf><responseElseIf><match><variable identifier="RESPONSE"/><baseValue baseType="identifier">RESPONSE_3</baseValue></match><setOutcomeValue identifier="SCORE"><baseValue baseType="float">0</baseValue></setOutcomeValue><setOutcomeValue identifier="FEEDBACK"><baseValue baseType="identifier">FEEDBACK_3</baseValue></setOutcomeValue></responseElseIf><responseElseIf><match><variable identifier="RESPONSE"/><baseValue baseType="identifier">RESPONSE_4</baseValue></match><setOutcomeValue identifier="SCORE"><baseValue baseType="float">0</baseValue></setOutcomeValue><setOutcomeValue identifier="FEEDBACK"><baseValue baseType="identifier">FEEDBACK_4</baseValue></setOutcomeValue></responseElseIf></responseCondition></responseProcessing><modalFeedback identifier="FEEDBACK_1" outcomeIdentifier="FEEDBACK" showHide="show"><div>Psychology: The Scientific Methodology, p. 27</div></modalFeedback><modalFeedback identifier="FEEDBACK_2" outcomeIdentifier="FEEDBACK" showHide="show"><div>Psychology: The Scientific Methodology, p. 27</div></modalFeedback><modalFeedback identifier="FEEDBACK_3" outcomeIdentifier="FEEDBACK" showHide="show"><div>Psychology: The Scientific Methodology, p. 27</div></modalFeedback><modalFeedback identifier="FEEDBACK_4" outcomeIdentifier="FEEDBACK" showHide="show"><div>Psychology: The Scientific Methodology, p. 27</div></modalFeedback></assessmentItem>';
				//var MultipleChoice_Template=  '<div class="qti-assessmentItem" data-qti-id="11" data-qti-tag="assessmentItem" data-qti-attribute-xmlns="http://www.imsglobal.org/xsd/imsqti_v2p1" data-qti-attribute-xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" data-qti-attribute-xsi:schemalocation="http://www.imsglobal.org/xsd/imsqti_v2p1 http://www.imsglobal.org/xsd/qti/qtiv2p1/imsqti_v2p1.xsd" data-qti-attribute-title="Pre 1.1.2" data-qti-attribute-identifier="QUESTION-1000001217597854" data-qti-attribute-label="Pre 1.1.2" data-qti-attribute-toolname="pegasus" data-qti-attribute-toolversion="5.152.49.2" data-qti-attribute-adaptive="false" data-qti-attribute-timedependent="false" style="position: relative;"><div class="qti-responseDeclaration" data-qti-id="12" data-qti-tag="responseDeclaration" data-qti-attribute-identifier="RESPONSE" data-qti-attribute-cardinality="single" data-qti-attribute-basetype="identifier" style="position: relative; display: none;"></div><div class="qti-itemBody" data-qti-id="13" data-qti-tag="itemBody" style="position: relative;"><p class="qti-p" data-qti-id="14" data-qti-tag="p" style="position: relative;">Multiple Choice Question (Single Response)</p><form class="qti-choiceInteraction" data-qti-id="15" data-qti-tag="choiceInteraction" data-qti-attribute-shuffle="false" data-qti-attribute-responseidentifier="RESPONSE" data-qti-attribute-maxchoices="1" data-qti-attribute-minchoices="1" style="position: relative;"><div class="qti-simpleChoice" data-qti-id="16" data-qti-tag="simpleChoice" data-qti-attribute-identifier="RESPONSE_1" data-qti-attribute-fixed="false" data-qti-attribute-index="A) " data-qti---fixed-boolean="false" style="position: relative;"><div class="radio"><span class="tick">✔</span><span>A) </span><label for="simpleChoice5" data---qti-content-container="true">Answer Choice</label></div></div><div class="qti-simpleChoice" data-qti-id="17" data-qti-tag="simpleChoice" data-qti-attribute-identifier="RESPONSE_2" data-qti-attribute-fixed="false" data-qti-attribute-index="B) " data-qti---fixed-boolean="false" style="position: relative;"><div class="radio"><span class="tick">✔</span><span>B) </span><label for="simpleChoice6" data---qti-content-container="true">Answer Choice</label></div></div><div class="qti-simpleChoice" data-qti-id="18" data-qti-tag="simpleChoice" data-qti-attribute-identifier="RESPONSE_3" data-qti-attribute-fixed="false" data-qti-attribute-index="C) " data-qti---fixed-boolean="false" style="position: relative;"><div class="radio"><span class="tick">✔</span><span>C) </span><label for="simpleChoice7" data---qti-content-container="true">Answer Choice</label></div></div><div class="qti-simpleChoice" data-qti-id="19" data-qti-tag="simpleChoice" data-qti-attribute-identifier="RESPONSE_4" data-qti-attribute-fixed="false" data-qti-attribute-index="D) " data-qti---fixed-boolean="false" style="position: relative;"><div class="radio"><span class="tick">✔</span><span>D) </span><label for="simpleChoice8" data---qti-content-container="true">Answer Choice</label></div></div></form></div><div class="qti-responseProcessing" data-qti-id="20" data-qti-tag="responseProcessing" style="position: relative; display: none;"></div></div>';
				// var MultipleChoice_Template = '<div class="qti-assessmentItem" data-qti-id="1" data-qti-tag="assessmentItem" data-qti-attribute-xmlns="http://www.imsglobal.org/xsd/imsqti_v2p1" data-qti-attribute-xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" data-qti-attribute-xsi:schemalocation="http://www.imsglobal.org/xsd/imsqti_v2p1 http://www.imsglobal.org/xsd/qti/qtiv2p1/imsqti_v2p1.xsd" data-qti-attribute-title="Pre 1.1.2" data-qti-attribute-identifier="QUESTION-1000001217597854" data-qti-attribute-label="Pre 1.1.2" data-qti-attribute-toolname="pegasus" data-qti-attribute-toolversion="5.152.49.2" data-qti-attribute-adaptive="false" data-qti-attribute-timedependent="false" style="position: relative;"><div class="qti-responseDeclaration" data-qti-id="2" data-qti-tag="responseDeclaration" data-qti-attribute-identifier="RESPONSE" data-qti-attribute-cardinality="single" data-qti-attribute-basetype="identifier" style="position: relative; display: none;"></div><div class="qti-itemBody" data-qti-id="3" data-qti-tag="itemBody" style="position: relative;"><p class="printView qti-p" data-qti-id="4" data-qti-tag="p" style="position: relative;">Multiple Choice Question (Single Response)</p><input class="editView" type="text" id="qtiCaption"><form class="qti-choiceInteraction" data-qti-id="5" data-qti-tag="choiceInteraction" data-qti-attribute-shuffle="false" data-qti-attribute-responseidentifier="RESPONSE" data-qti-attribute-maxchoices="1" data-qti-attribute-minchoices="1" style="position: relative;"><div class="qti-simpleChoice" data-qti-id="6" data-qti-tag="simpleChoice" data-qti-attribute-identifier="RESPONSE_1" data-qti-attribute-fixed="false" data-qti-attribute-index="A) " data-qti---fixed-boolean="false" style="position: relative;"><div class="radio"><span class="tick">✔</span><span>A) </span><label for="simpleChoice1" data---qti-content-container="true">Answer Choice</label></div></div><div class="qti-simpleChoice" data-qti-id="7" data-qti-tag="simpleChoice" data-qti-attribute-identifier="RESPONSE_2" data-qti-attribute-fixed="false" data-qti-attribute-index="B) " data-qti---fixed-boolean="false" style="position: relative;"><div class="radio"><span class="tick">✔</span><span>B) </span><label for="simpleChoice2" data---qti-content-container="true">Answer Choice</label></div></div><div class="qti-simpleChoice" data-qti-id="8" data-qti-tag="simpleChoice" data-qti-attribute-identifier="RESPONSE_3" data-qti-attribute-fixed="false" data-qti-attribute-index="C) " data-qti---fixed-boolean="false" style="position: relative;"><div class="radio"><span class="tick">✔</span><span>C) </span><label for="simpleChoice3" data---qti-content-container="true">Answer Choice</label></div></div><div class="qti-simpleChoice" data-qti-id="9" data-qti-tag="simpleChoice" data-qti-attribute-identifier="RESPONSE_4" data-qti-attribute-fixed="false" data-qti-attribute-index="D) " data-qti---fixed-boolean="false" style="position: relative;"><div class="radio"><span class="tick">✔</span><span>D) </span><label for="simpleChoice4" data---qti-content-container="true">Answer Choice</label></div></div></form></div><div class="qti-responseProcessing" data-qti-id="10" data-qti-tag="responseProcessing" style="position: relative; display: none;"></div></div>'
				// var TrueFalse_Template = '<div class="qti-assessmentItem" data-qti-id="62" data-qti-tag="assessmentItem" data-qti-attribute-xmlns="http://www.imsglobal.org/xsd/imsqti_v2p1" data-qti-attribute-xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" data-qti-attribute-xsi:schemalocation="http://www.imsglobal.org/xsd/imsqti_v2p1 http://www.imsglobal.org/xsd/qti/qtiv2p1/imsqti_v2p1.xsd" data-qti-attribute-title="True/False" data-qti-attribute-identifier="QUESTION-1334052738" data-qti-attribute-label="True/False" data-qti-attribute-toolname="pegasus" data-qti-attribute-toolversion="5.152.49.2" data-qti-attribute-adaptive="false" data-qti-attribute-timedependent="false" style="position: relative;"><div class="qti-responseDeclaration" data-qti-id="63" data-qti-tag="responseDeclaration" data-qti-attribute-identifier="RESPONSE" data-qti-attribute-cardinality="single" data-qti-attribute-basetype="identifier" style="position: relative; display: none;"></div><div class="qti-itemBody" data-qti-id="64" data-qti-tag="itemBody" style="position: relative;"><p class="qti-p" data-qti-id="65" data-qti-tag="p" style="position: relative;"><font class="qti-font" data-qti-id="66" data-qti-tag="font" data-qti-attribute-face="Arial" style="position: relative;">True/False Question</font></p><form class="qti-choiceInteraction" data-qti-id="67" data-qti-tag="choiceInteraction" data-qti-attribute-shuffle="false" data-qti-attribute-responseidentifier="RESPONSE" data-qti-attribute-maxchoices="1" data-qti-attribute-minchoices="1" style="position: relative;"><div class="qti-simpleChoice" data-qti-id="68" data-qti-tag="simpleChoice" data-qti-attribute-identifier="RESPONSE_1" data-qti-attribute-fixed="false" data-qti-attribute-index="A) " data-qti---fixed-boolean="false" style="position: relative;"><div class="radio"><span class="tick" style="visibility: visible;">✔</span><span>A) </span><label for="simpleChoice9" data---qti-content-container="true">True</label></div></div><div class="qti-simpleChoice" data-qti-id="69" data-qti-tag="simpleChoice" data-qti-attribute-identifier="RESPONSE_2" data-qti-attribute-fixed="false" data-qti-attribute-index="B) " data-qti---fixed-boolean="false" style="position: relative;"><div class="radio"><span class="tick">✔</span><span>B) </span><label for="simpleChoice10" data---qti-content-container="true">False</label></div></div></form></div><div class="qti-responseProcessing" data-qti-id="70" data-qti-tag="responseProcessing" style="position: relative; display: none;"></div></div>'

				this.questionTemplates = function(qtiFormat) {

					var qtiXmlNode = [];
					var nodes = [];
					QTI.initialize();
					nodes = nodes.concat(MultipleChoice_Template);							
					angular.forEach(nodes, function(item) {
						var displayNode = $("<div></div>");
						QTI.Attribute.id = 1;		
						 QTI.id=1;
						QTI.play(item, displayNode, true,true);	
						var node = {};
						node.optionsView = true;
						node.data = MultipleChoice_Template;
						node.textHTML = displayNode.html();
						node.template = 'questions_renderer.html';
						qtiXmlNode.push(node);
					})

					return qtiXmlNode;

				};
			
			
		}]);			